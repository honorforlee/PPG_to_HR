%%
Name = 'a07m';

load(strcat(Name, '.mat'));
fid = fopen(strcat(Name, '.info'), 'rt');
fgetl(fid);
fgetl(fid);
fgetl(fid);
[interval] = sscanf(fgetl(fid), 'Sampling frequency: %f Hz  Sampling interval: %f sec');
interval = interval(2);

fclose(fid);

t = (1:500) * interval;          %timeline
s = val(1:500);                 %non zero val

s  = (s  - mean(s ))/sqrt(var(s ));

%Quantisize

dt = 8e-2;                            %t_sample
quant = 0.1;                          %vertical step
subels = 1:round(dt/interval):length(t);
subt = t(subels); subval = s(subels); %sample timeline
subval = quant*floor(subval/quant);  %sampled value

% Derivative
d = s(2:end) -  s(1:end-1);
td = (  t(2:end) +  t(1:end-1) ) / 2; 

kx = d > 0;                                 
kx = find(kx(1:end-1) & ~kx(2:end));       % k_x:index where d>0 and k_x+1<=0

sx = s(kx+1);                               
%tx = td(kx) + (td(kx+1)-td(kx)) .* d(kx)./(d(kx)-d(kx+1));
tx = td(

plot(t, s, subt, subval, 'ro--',td,d,'gx--',tx,sx,'cx--');
xlabel('Time (sec)');

